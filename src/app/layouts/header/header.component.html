<nav class="navbar navbar-dark bg-dark">
  <div class="container-fluid">
    <a class="navbar-brand" href="#" [routerLink]="'/inicio'">
      <img src="assets/logo.png" alt="Logo" width="50" height="50" class="d-inline-block align-text-top">
    </a>
    <div class="d-flex justify-content-center flex-grow-1">
      <div class="search-container">
        <div class="input-group">
          <span class="input-group-text bg-dark border-secondary">
            <i class="bi bi-search text-light"></i>
          </span>
          <input type="text" class="form-control bg-dark text-light border-secondary" placeholder="Buscar..." [(ngModel)]="searchQuery" (input)="filterUsers()" (click)="$event.stopPropagation()">
        </div>
        <!-- Resultados de bÃºsqueda como overlay -->
        <div *ngIf="filteredUsers.length > 0" class="search-results">
          <ul class="list-unstyled m-0">
            <li *ngFor="let user of filteredUsers" class="search-item d-flex align-items-center" (click)="navigateToUserProfile(user.id)">
              <div class="user-avatar">
                <img *ngIf="user.urlFoto" [src]="getImageUrl(user.urlFoto)" alt="Foto de usuario" class="rounded-circle" width="36" height="36">
                <i *ngIf="!user.urlFoto" class="bi bi-person-circle fs-4 text-light"></i>
              </div>
              <div class="ms-2 user-info">
                <strong class="text-light">{{ user.username }}</strong>
                <div class="text-muted small">Ver perfil</div>
              </div>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="d-flex align-items-center">
      <div class="theme-toggle" [class.light]="isLightTheme" (click)="toggleTheme()">
        <div class="theme-toggle-track"></div>
        <div class="theme-toggle-thumb">
          <i *ngIf="isLightTheme" class="bi bi-brightness-high theme-toggle-icon"></i>
          <i *ngIf="!isLightTheme" class="bi bi-moon theme-toggle-icon"></i>
        </div>
      </div>

      <div *ngIf="isAuthenticated; else loggedOut">
        <button class="btn btn-link text-light ms-2" [routerLink]="'/mi-perfil'">
          <img *ngIf="userFotoUrl" [src]="userFotoUrl" alt="Foto de perfil" class="rounded-circle" width="30" height="30">
          <i *ngIf="!userFotoUrl" class="bi bi-person-circle fs-4"></i>
        </button>
        <button class="btn btn-link text-light ms-2" (click)="logout()">
          <i class="bi bi-box-arrow-right fs-4"></i>
        </button>
      </div>

      <ng-template #loggedOut>
        <button class="btn btn-link text-light ms-2" [routerLink]="'/auth'">
          <i class="bi bi-person-circle fs-4"></i>
        </button>
      </ng-template>
    </div>
  </div>
</nav>
